(this["webpackJsonpreact-spreadsheeter"]=this["webpackJsonpreact-spreadsheeter"]||[]).push([[0],{61:function(e,t){},82:function(e,t,a){},83:function(e,t,a){},88:function(e,t){},89:function(e,t){},95:function(e,t,a){"use strict";a.r(t);var n=a(6),o=a(0),r=a.n(o),c=a(9),s=a.n(c),l=a(138),i=a(39),h=a(40),d=a(50),b=a(49),p=a.p+"static/media/logo.103b5fa1.svg",j=(a(82),a(67)),u=a(14),v=a(24),O=a(128),f=a(140),m=a(132),y=a(139),g=a(135),x=a(133),S=a(143),C=a(134),w=a(142),D=a(141),F=a(136),k=a(137),A=(a(83),a(51)),N=a(62),P=a.n(N),E=a(55),I="React-Spreadsheeter";function T(e){return'"'+e.replace(/"/g,"'").replace(/,/g,'";"').replace(/(\n)/gm,'"\r\n"')+'"\r\n'}function R(e,t,a){if("xlsx"===a)!function(e,t){if(!e||e.length<1)throw new Error("No data to export...");var a=A.read(T(e[0].data),{type:"string"});a.Props=Object(u.a)(Object(u.a)({},a.Props),{},{Title:t,Author:I,CreatedDate:new Date,ModifiedDate:new Date,Comments:"Generated by "+I,Keywords:"CSV,sheets",Category:"Spreadsheets"}),a.SheetNames[0]=e[0].name,a.Sheets[e[0].name]=a.Sheets.Sheet1,delete a.Sheets.Sheet1,e.slice(1).forEach((function(e){var t=e.name,n=e.data,o=A.read(T(n),{type:"string"});a.SheetNames.push(t),a.Sheets[t]=o.Sheets.Sheet1})),A.writeFile(a,t)}(e,t+"."+a);else if("zip"===a){var n=new P.a;e.forEach((function(e){var t=e.data,a=e.name;return n.file(a+".csv",t)})),n.generateAsync({type:"blob",comment:"Generated by "+I},(function(e){var t;console.log("Generating archive (".concat(null!==(t=e.currentFile)&&void 0!==t?t:"done","): ").concat(e.percent.toFixed(2),"%"))})).then((function(e){Object(E.saveAs)(e,t+".zip")}))}else e.forEach((function(e){var n=e.name;!function(e,t,a){var n;n="csv"===a?new Blob([T(e)],{type:"text/csv;charset=utf-8"}):new Blob([e],{type:"text/plain;charset=utf-8"}),Object(E.saveAs)(n,t+"."+a)}(e.data,t+"-"+n,a)}))}var z,B=a(25),V=a.n(B),G=(z=function(e){Object(d.a)(a,e);var t=Object(b.a)(a);function a(e){var n;Object(i.a)(this,a),n=t.call(this,e);var o=e.label,r=e.btn,c=e.fileName;return n.state={label:null!==o&&void 0!==o?o:"Sheets data",btn:null!==r&&void 0!==r?r:"Save",fileName:null!==c&&void 0!==c?c:"spreadsheet",format:"txt",saveAll:!1,sheets:[{name:"S1",data:""}],selectedSheetIdx:0},n}return Object(h.a)(a,[{key:"addSheet",value:function(){var e=this.state.sheets,t=e.length;this.setState(Object(u.a)(Object(u.a)({},this.state),{},{sheets:[].concat(Object(j.a)(e),[{name:"S".concat(t+1),data:""}]),selectedSheetIdx:t}))}},{key:"onChangeFormat",value:function(e){var t;this.setState(Object(u.a)(Object(u.a)({},this.state),{},{format:null===(t=e.target)||void 0===t?void 0:t.value}))}},{key:"onChangeSaveAll",value:function(e){var t=e.target.checked;this.setState(Object(u.a)(Object(u.a)({},this.state),{},{saveAll:t}))}},{key:"onTabChange",value:function(e,t){this.setState(Object(u.a)(Object(u.a)({},this.state),{},{selectedSheetIdx:t}))}},{key:"onChangeSheet",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data";this.setState(Object(u.a)(Object(u.a)({},this.state),{},{sheets:this.state.sheets.map((function(n,o){var r;t===o&&(n[a]=null===(r=e.target)||void 0===r?void 0:r.value);return n}))}))}},{key:"onRemoveSheet",value:function(e,t){this.setState(Object(u.a)(Object(u.a)({},this.state),{},{sheets:this.state.sheets.filter((function(e,a){return a!==t})),selectedSheetIdx:0}))}},{key:"saveData",value:function(e){e.preventDefault();var t=this.state,a=t.fileName,n=t.format,o=t.saveAll,r=t.sheets,c=t.selectedSheetIdx,s=function(e){var t="";if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(t=(new Date).toISOString().slice(2,19).replace(/[:\-]/g,"")+"-"),e)t+=e;else{var a=new Uint8Array(4);crypto.getRandomValues(a),t+=Array.from(a,(function(e){return(e<10?"0"+e:e).toString(16)})).join("")}return t}(a);R(o?r:[r[c]],s,n)}},{key:"render",value:function(){var e=this,t=this.state,a=t.label,o=t.btn,r=t.sheets,c=t.selectedSheetIdx,s=Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(O.a,{position:"static",color:"default",children:Object(n.jsx)(f.a,{value:null!==c&&void 0!==c?c:0,onChange:this.onTabChange,indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto","aria-label":"scrollable auto tabs example",children:r.map((function(e,t){return Object(n.jsx)(m.a,{label:e.name,id:"scrollable-auto-tab-".concat(t),"aria-controls":"scrollable-auto-tabpanel-".concat(t)},"tab-header-"+t)}))})}),r.map((function(t,a){return Object(n.jsxs)("section",{"aria-labelledby":"scrollable-auto-tab-".concat(a),hidden:a!==c,id:"scrollable-auto-tabpanel-".concat(a),role:"tabpanel",children:[Object(n.jsxs)("section",{className:"data-header",children:[Object(n.jsx)(y.a,{id:"s".concat(a,"-name"),fullWidth:!0,label:"Sheet name",value:t.name,variant:"outlined",onChange:function(t){return e.onChangeSheet(t,a,"name")}}),a>0&&Object(n.jsx)(g.a,{color:"secondary",disableElevation:!0,type:"button",variant:"contained",onClick:function(t){return e.onRemoveSheet(t,a)},children:Object(n.jsx)(F.a,{})})]}),Object(n.jsx)(y.a,{id:"s".concat(a,"-data"),fullWidth:!0,label:"Sheet data",multiline:!0,rows:4,value:t.data,variant:"outlined",onChange:function(t){return e.onChangeSheet(t,a)}})]},"tab-field-"+a)}))]});return Object(n.jsxs)("form",{onSubmit:this.saveData,children:[Object(n.jsxs)("section",{className:"space-items",children:[Object(n.jsx)("h2",{children:a}),Object(n.jsxs)(g.a,{color:"primary",disableElevation:!0,onClick:this.addSheet,size:"small",type:"button",variant:"contained",children:[Object(n.jsx)(k.a,{})," Add new sheet"]})]}),Object(n.jsx)("section",{className:"sheets",children:s}),Object(n.jsxs)("section",{className:"space-items",children:[Object(n.jsxs)(x.a,{children:[Object(n.jsxs)(y.a,{select:!0,defaultValue:"txt",label:"File type",name:"format",onChange:this.onChangeFormat,variant:"outlined",children:[Object(n.jsx)(S.a,{value:"csv",children:"CSV"}),Object(n.jsx)(S.a,{value:"xlsx",children:"Excel"}),Object(n.jsx)(S.a,{value:"txt",children:"Text"}),Object(n.jsx)(S.a,{value:"zip",children:"Zip"})]}),Object(n.jsx)(C.a,{children:"File format to export"})]}),Object(n.jsx)(w.a,{control:Object(n.jsx)(D.a,{color:"primary",onChange:this.onChangeSaveAll}),label:"Save all sheets",labelPlacement:"end"}),Object(n.jsx)(g.a,{disableElevation:!0,color:"primary",size:"large",type:"submit",variant:"contained",children:o})]})]})}}]),a}(o.Component),Object(v.a)(z.prototype,"addSheet",[V.a],Object.getOwnPropertyDescriptor(z.prototype,"addSheet"),z.prototype),Object(v.a)(z.prototype,"onChangeFormat",[V.a],Object.getOwnPropertyDescriptor(z.prototype,"onChangeFormat"),z.prototype),Object(v.a)(z.prototype,"onChangeSaveAll",[V.a],Object.getOwnPropertyDescriptor(z.prototype,"onChangeSaveAll"),z.prototype),Object(v.a)(z.prototype,"onTabChange",[V.a],Object.getOwnPropertyDescriptor(z.prototype,"onTabChange"),z.prototype),Object(v.a)(z.prototype,"onChangeSheet",[V.a],Object.getOwnPropertyDescriptor(z.prototype,"onChangeSheet"),z.prototype),Object(v.a)(z.prototype,"onRemoveSheet",[V.a],Object.getOwnPropertyDescriptor(z.prototype,"onRemoveSheet"),z.prototype),Object(v.a)(z.prototype,"saveData",[V.a],Object.getOwnPropertyDescriptor(z.prototype,"saveData"),z.prototype),z),J=function(e){Object(d.a)(a,e);var t=Object(b.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("header",{className:"main-header",children:[Object(n.jsx)("img",{src:p,className:"logo",alt:"logo"}),Object(n.jsx)("h1",{children:"Spreadsheeter"}),Object(n.jsx)("p",{children:"Export and save your data into different file formats"})]}),Object(n.jsx)("main",{children:Object(n.jsx)(G,{btn:"Export",fileName:"sheet"})})]})}}]),a}(o.Component),L=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,144)).then((function(t){var a=t.getCLS,n=t.getFID,o=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),n(e),o(e),r(e),c(e)}))};s.a.render(Object(n.jsxs)(r.a.StrictMode,{children:[Object(n.jsx)(l.a,{}),Object(n.jsx)(J,{})]}),document.getElementById("root")),L()}},[[95,1,2]]]);
//# sourceMappingURL=main.e109a48e.chunk.js.map